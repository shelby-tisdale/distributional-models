<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.54">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Distributional Models for Adolescent Brain Development</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="dashboard_files/libs/clipboard/clipboard.min.js"></script>
<script src="dashboard_files/libs/quarto-html/quarto.js"></script>
<script src="dashboard_files/libs/quarto-html/popper.min.js"></script>
<script src="dashboard_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="dashboard_files/libs/quarto-html/anchor.min.js"></script>
<link href="dashboard_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="dashboard_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="dashboard_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="dashboard_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="dashboard_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="dashboard_files/libs/quarto-dashboard/quarto-dashboard.js"></script>
<script src="dashboard_files/libs/quarto-dashboard/stickythead.js"></script>
<script src="dashboard_files/libs/quarto-dashboard/datatables.min.js" kdttablesentinel="true"></script>
<script src="dashboard_files/libs/quarto-dashboard/pdfmake.min.js" kdttablesentinel="true"></script>
<script src="dashboard_files/libs/quarto-dashboard/vfs_fonts.js" kdttablesentinel="true"></script>
<script src="dashboard_files/libs/quarto-dashboard/web-components.js" type="module"></script>
<script src="dashboard_files/libs/quarto-dashboard/components.js"></script>
<link href="dashboard_files/libs/quarto-dashboard/datatables.min.css" rel="stylesheet" kdttablesentinel="true">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="quarto-dashboard dashboard-sidebar fullcontent">

<header id="quarto-dashboard-header">
<nav class="navbar navbar-expand-md slim" data-bs-theme="dark">
  <div class="navbar-container container-fluid">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#dashboard-collapse" aria-controls="dashboard-collapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>    


    <div class="navbar-brand-container">       

      <div class="navbar-title">
        <div class="navbar-title-text"><a href="#">Distributional Models for Adolescent Brain Development</a></div>
        
        
      </div>
    </div>
<div id="dashboard-collapse" class="navbar-collapse collapse"><ul class="navbar-nav navbar-nav-scroll me-auto" role="tablist"><li class="nav-item" role="presentation"><a id="tab-home" class="nav-link active" data-bs-toggle="tab" role="tab" data-bs-target="#home" data-scrolling="true" href="#home" aria-controls="home" aria-selected="true"><span class="nav-link-text">Home</span></a></li><li class="nav-item" role="presentation"><a id="tab-centile-estimation" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#centile-estimation" data-scrolling="true" href="#centile-estimation" aria-controls="centile-estimation" aria-selected="false"><span class="nav-link-text">Centile Estimation</span></a></li><li class="nav-item" role="presentation"><a id="tab-spatial-visualization" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#spatial-visualization" data-scrolling="true" href="#spatial-visualization" aria-controls="spatial-visualization" aria-selected="false"><span class="nav-link-text">Spatial Visualization</span></a></li><li class="nav-item" role="presentation"><a id="tab-cortical-thickness" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#cortical-thickness" data-scrolling="true" href="#cortical-thickness" aria-controls="cortical-thickness" aria-selected="false"><span class="nav-link-text">Cortical Thickness</span></a></li><li class="nav-item" role="presentation"><a id="tab-cortical-surface-area" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#cortical-surface-area" data-scrolling="true" href="#cortical-surface-area" aria-controls="cortical-surface-area" aria-selected="false"><span class="nav-link-text">Cortical Surface Area</span></a></li><li class="nav-item" role="presentation"><a id="tab-about-us" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#about-us" data-scrolling="true" href="#about-us" aria-controls="about-us" aria-selected="false"><span class="nav-link-text">About Us</span></a></li></ul></div></div>
</nav>
</header>
<div class="page-layout-custom quarto-dashboard-content bslib-gap-spacing html-fill-container dashboard-scrolling quarto-dashboard-pages">  

<div class="bslib-grid-item html-fill-item tab-content bslib-grid" data-layout="flow" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div id="home" class="dashboard-page tab-pane show active html-fill-item html-fill-container" data-orientation="rows" aria-labelledby="tab-home">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 20fr) minmax(3em, 70fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card html-fill-item html-fill-container bslib-card" data-title="About the Dashboard" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title">About the Dashboard</div></div>
<div class="card-body html-fill-item html-fill-container">
<p>Distributional modeling, also known as normative modeling, allows for the creation of centile curves to visualize the variation of a developmental phenotype as a function of age. Previous studies have utilized a variety of modeling approaches, including Bayesian regression, Gaussian processes, and Generalized Additive Models for Location, Scale, and Shape (GAMLSS) to model trajectories of cortical thickness and cortical surface area over the course of the human lifespan. Such studies typically incorporate a cross-sectional design, generally discarding non-baseline data from longitudinal data sources and failing to account for within-person changes across time. Additionally, while many studies plot centile curves separately for each sex and utilize random effects to account for site- and/or study-related variability, other demographic factors, such as race, are not considered in the distributional models.</p>
<p>This project addresses these limitations through the creation of longitudinal distributional models for cortical thickness and surface area of adolescents ages 9 to 15, stratified by race and sex, for 70 different brain regions. Spatial and longitudinal results are visualized in this interactive dashboard – explore to learn more!</p>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 50fr) minmax(3em, 50fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card html-fill-item html-fill-container bslib-card" data-title="Methods" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title">Methods</div></div>
<div class="card-body html-fill-item html-fill-container">
<p><strong>Data</strong> This study utilizes MRI data from the <a href="https://abcdstudy.org/">Adolescent Brain Cognitive Development (ABCD) Study</a>, a large, multi-site, longitudinal study of adolescent health and brain development in the United States. The sample includes all study participants with MRI data at least one timepoint. Sample demographics are summarized in Table 1.</p>
<p><strong>Modeling</strong> Models were fitted with the <a href="https://www.gamlss.com/">Generalized Additive Models for Location, Scale, and Shape (GAMLSS) R package</a>. Models for Cortical thickness (CT) and Cortical Surface Area (CSA) for the <span class="math inline">\(i^{th}\)</span> combination of race, sex, and brain region are as follows:</p>
<p><span class="math display">\[
\text{CSA}_i \sim \text{Box-Cox Power Exponential}(\mu_i, \sigma_i, \nu_i, \tau_i) \text{ with}
\]</span> <span class="math display">\[
\log(\mu_i) = \alpha_{\mu_i} + s_{\mu_i}(\text{age}^{p_i}) + \gamma_{\mu_i, \text{site}} + \gamma_{\mu_i, \text{subject}}
\]</span> <span class="math display">\[
\log(\sigma_i) = \alpha_{\sigma_i} + s_{\sigma_i}(\text{age})
\]</span> <span class="math display">\[
\nu_i = \alpha_{\nu_i} + \beta_{\nu_i,1}\text{age}\]</span> <span class="math display">\[
\tau_i = \alpha_{\tau_i} + \beta_{\tau_i,1}\text{age}
\]</span></p>
<p><span class="math display">\[
\text{CT}_i \sim \text{Box-Cox T}(\mu_i, \sigma_i, \nu_i, \tau_i) \text{ with}
\]</span> <span class="math display">\[
\log(\mu_i) = \alpha_{\mu_i} + s_{\mu_i}(\text{age}^{p_i}) + \gamma_{\mu_i, \text{site}} + \gamma_{\mu_i, \text{subject}}
\]</span> <span class="math display">\[
\log(\sigma_i) = \alpha_{\sigma_i} + s_{\sigma_i}(\text{age})
\]</span> <span class="math display">\[
\nu_i = \alpha_{\nu_i} + \beta_{\nu_i,1}\text{age}\]</span> <span class="math display">\[
\tau_i = \alpha_{\tau_i} + \beta_{\tau_i,1}\text{age}
\]</span>where:</p>
<ul>
<li><span class="math inline">\(\alpha\)</span> terms correspond to fixed effects of the intercept</li>
<li><span class="math inline">\(\beta\)</span> terms correspond to fixed effects of age</li>
<li><span class="math inline">\(\lambda\)</span> terms correspond to random site-level and subject-level random effects</li>
<li>P-spline smoothing terms <span class="math inline">\(s\)</span> are included for adolescent age for <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>.</li>
<li>Adolescent age was transformed using GAMLSS functions which found the optimal power transformation, <span class="math inline">\(\pi\)</span>, for each model.</li>
</ul>
<p>Models were fit separately for each combination of race, sex, and region of the brain, resulting in 1704 total models.</p>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div><div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Table 1. Sample Demographics" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title">Table 1. Sample Demographics</div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div id="jljuqkqvzl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;" class="html-fill-item html-fill-container">
<style>#jljuqkqvzl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jljuqkqvzl thead, #jljuqkqvzl tbody, #jljuqkqvzl tfoot, #jljuqkqvzl tr, #jljuqkqvzl td, #jljuqkqvzl th {
  border-style: none;
}

#jljuqkqvzl p {
  margin: 0;
  padding: 0;
}

#jljuqkqvzl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jljuqkqvzl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jljuqkqvzl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jljuqkqvzl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jljuqkqvzl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jljuqkqvzl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jljuqkqvzl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jljuqkqvzl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jljuqkqvzl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jljuqkqvzl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jljuqkqvzl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jljuqkqvzl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jljuqkqvzl .gt_spanner_row {
  border-bottom-style: hidden;
}

#jljuqkqvzl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jljuqkqvzl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jljuqkqvzl .gt_from_md > :first-child {
  margin-top: 0;
}

#jljuqkqvzl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jljuqkqvzl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jljuqkqvzl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jljuqkqvzl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jljuqkqvzl .gt_row_group_first td {
  border-top-width: 2px;
}

#jljuqkqvzl .gt_row_group_first th {
  border-top-width: 2px;
}

#jljuqkqvzl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jljuqkqvzl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jljuqkqvzl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jljuqkqvzl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jljuqkqvzl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jljuqkqvzl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jljuqkqvzl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jljuqkqvzl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jljuqkqvzl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jljuqkqvzl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jljuqkqvzl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jljuqkqvzl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jljuqkqvzl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jljuqkqvzl .gt_left {
  text-align: left;
}

#jljuqkqvzl .gt_center {
  text-align: center;
}

#jljuqkqvzl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jljuqkqvzl .gt_font_normal {
  font-weight: normal;
}

#jljuqkqvzl .gt_font_bold {
  font-weight: bold;
}

#jljuqkqvzl .gt_font_italic {
  font-style: italic;
}

#jljuqkqvzl .gt_super {
  font-size: 65%;
}

#jljuqkqvzl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jljuqkqvzl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jljuqkqvzl .gt_indent_1 {
  text-indent: 5px;
}

#jljuqkqvzl .gt_indent_2 {
  text-indent: 10px;
}

#jljuqkqvzl .gt_indent_3 {
  text-indent: 15px;
}

#jljuqkqvzl .gt_indent_4 {
  text-indent: 20px;
}

#jljuqkqvzl .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header gt_heading">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border"><strong>Table 1</strong>. ABCD Sample Demographics, N = 22,633<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
</tr>
<tr class="odd gt_col_headings gt_spanner_row">
<th rowspan="2" id="<strong>Characteristic</strong>" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th colspan="4" id="<strong>Timepoint</strong>" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner"><strong>Timepoint</strong></span></th>
</tr>
<tr class="header gt_col_headings">
<th id="<strong>Overall</strong><br> N = 22,631<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Overall</strong><br>
N = 22,631<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
<th id="<strong>Baseline</strong><br> N = 11,690<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Baseline</strong><br>
N = 11,690<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
<th id="<strong>2-Year Follow Up</strong><br> N = 7,981<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>2-Year Follow Up</strong><br>
N = 7,981<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
<th id="<strong>4-Year Follow Up</strong><br> N = 2,960<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>4-Year Follow Up</strong><br>
N = 2,960<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Race</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;White</td>
<td class="gt_row gt_center" headers="stat_0">12,207 (54%)</td>
<td class="gt_row gt_center" headers="stat_1">6,115 (52%)</td>
<td class="gt_row gt_center" headers="stat_2">4,402 (55%)</td>
<td class="gt_row gt_center" headers="stat_3">1,690 (57%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Hispanic</td>
<td class="gt_row gt_center" headers="stat_0">4,478 (20%)</td>
<td class="gt_row gt_center" headers="stat_1">2,368 (20%)</td>
<td class="gt_row gt_center" headers="stat_2">1,520 (19%)</td>
<td class="gt_row gt_center" headers="stat_3">590 (20%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Black</td>
<td class="gt_row gt_center" headers="stat_0">3,108 (14%)</td>
<td class="gt_row gt_center" headers="stat_1">1,728 (15%)</td>
<td class="gt_row gt_center" headers="stat_2">1,073 (13%)</td>
<td class="gt_row gt_center" headers="stat_3">307 (10%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Not Listed</td>
<td class="gt_row gt_center" headers="stat_0">2,372 (10%)</td>
<td class="gt_row gt_center" headers="stat_1">1,230 (11%)</td>
<td class="gt_row gt_center" headers="stat_2">834 (10%)</td>
<td class="gt_row gt_center" headers="stat_3">308 (10%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Asian</td>
<td class="gt_row gt_center" headers="stat_0">466 (2.1%)</td>
<td class="gt_row gt_center" headers="stat_1">249 (2.1%)</td>
<td class="gt_row gt_center" headers="stat_2">152 (1.9%)</td>
<td class="gt_row gt_center" headers="stat_3">65 (2.2%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Sex Assigned at Birth</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Male</td>
<td class="gt_row gt_center" headers="stat_0">11,992 (53%)</td>
<td class="gt_row gt_center" headers="stat_1">6,110 (52%)</td>
<td class="gt_row gt_center" headers="stat_2">4,305 (54%)</td>
<td class="gt_row gt_center" headers="stat_3">1,577 (53%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Female</td>
<td class="gt_row gt_center" headers="stat_0">10,639 (47%)</td>
<td class="gt_row gt_center" headers="stat_1">5,580 (48%)</td>
<td class="gt_row gt_center" headers="stat_2">3,676 (46%)</td>
<td class="gt_row gt_center" headers="stat_3">1,383 (47%)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="5" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> Sample includes 22,633 total observations from 11,692 unique participants. At baseline, participants are primarily ages 9 and 10. Participants are primarily ages 11 and 12 at the 2-year follow-up timepoint and ages 13 and 14 at the 4-year follow-up timepoint.</td>
</tr>
<tr class="odd">
<td colspan="5" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
</div>
</div>
<div id="centile-estimation" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container dashboard-sidebar-container" data-orientation="rows" aria-labelledby="tab-centile-estimation">
<div class="bslib-sidebar-layout html-fill-item html-fill-container" data-bslib-sidebar-open="desktop" data-bslib-sidebar-init="true" style=" --bslib-sidebar-width: 30%" data-bslib-sidebar-border="false" data-bslib-sidebar-border-radius="false"><div class="main html-fill-container html-fill-item"><div class="sidebar-content html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 25fr) minmax(3em, 75fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div id="birthday" class="shiny-date-input form-group shiny-input-container html-fill-item html-fill-container">
<label class="control-label" id="birthday-label" for="birthday">Date of Birth (yyyy/mm/dd)</label>
<input type="text" class="form-control" aria-labelledby="birthday-label" title="Date format: yyyy-mm-dd" data-date-language="en" data-date-week-start="0" data-date-format="yyyy-mm-dd" data-date-start-view="month" data-date-autoclose="true" data-date-dates-disabled="null" data-date-days-of-week-disabled="null">
</div>
</div>
<div class="cell-output-display html-fill-item html-fill-container">
<div id="baseline_date" class="shiny-date-input form-group shiny-input-container html-fill-item html-fill-container">
<label class="control-label" id="baseline_date-label" for="baseline_date">Date of Baseline Visit</label>
<input type="text" class="form-control" aria-labelledby="baseline_date-label" title="Date format: yyyy-mm-dd" data-date-language="en" data-date-week-start="0" data-date-format="yyyy-mm-dd" data-date-start-view="month" data-date-autoclose="true" data-date-dates-disabled="null" data-date-days-of-week-disabled="null">
</div>
</div>
<div class="cell-output-display html-fill-item html-fill-container">
<div class="form-group shiny-input-container html-fill-item html-fill-container">
<label class="control-label" id="baseline_input-label" for="baseline_input">Baseline Value</label>
<input id="baseline_input" type="number" class="shiny-input-number form-control" value="0">
</div>
</div>
<div class="cell-output-display html-fill-item html-fill-container">
<div id="year2_date" class="shiny-date-input form-group shiny-input-container html-fill-item html-fill-container">
<label class="control-label" id="year2_date-label" for="year2_date">Date of Year 2 Follow-up</label>
<input type="text" class="form-control" aria-labelledby="year2_date-label" title="Date format: yyyy-mm-dd" data-date-language="en" data-date-week-start="0" data-date-format="yyyy-mm-dd" data-date-start-view="month" data-date-autoclose="true" data-date-dates-disabled="null" data-date-days-of-week-disabled="null">
</div>
</div>
<div class="cell-output-display html-fill-item html-fill-container">
<div class="form-group shiny-input-container html-fill-item html-fill-container">
<label class="control-label" id="year2_input-label" for="year2_input">Year 2 Value</label>
<input id="year2_input" type="number" class="shiny-input-number form-control" value="0">
</div>
</div>
<div class="cell-output-display html-fill-item html-fill-container">
<div id="year4_date" class="shiny-date-input form-group shiny-input-container html-fill-item html-fill-container">
<label class="control-label" id="year4_date-label" for="year4_date">Date of Year 4 Follow-up</label>
<input type="text" class="form-control" aria-labelledby="year4_date-label" title="Date format: yyyy-mm-dd" data-date-language="en" data-date-week-start="0" data-date-format="yyyy-mm-dd" data-date-start-view="month" data-date-autoclose="true" data-date-dates-disabled="null" data-date-days-of-week-disabled="null">
</div>
</div>
<div class="cell-output-display html-fill-item html-fill-container">
<div class="form-group shiny-input-container html-fill-item html-fill-container">
<label class="control-label" id="year4_input-label" for="year4_input">Year 4 Value</label>
<input id="year4_input" type="number" class="shiny-input-number form-control" value="0">
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div><div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="shiny-plot-output html-fill-item html-fill-container" id="ctplot" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
</div></div><aside id="bslib-sidebar-1" class="sidebar html-fill-container html-fill-item"><div class="html-fill-item html-fill-container">
<p>Welcome to the Centile Estimation feature. This feature allows you to input your information and receive a personalized visualization of centile scores and trajectory over time based on distributional models. The default settings display centile curves and score for both hemispheres of the brain on the same plot.</p>
<p>Please note the following:</p>
<ul>
<li>Gaps in centile curves represent ages (by months) for which we don’t have data.</li>
<li>Leave values for which you don’t have data as 0.</li>
<li>Values for cortical surface area are in units of <span class="math inline">\(\text{mm}^2\)</span>, and values of cortical thickness are in units of <span class="math inline">\(\text{mm}\)</span>.</li>
<li>Selecting “all” areas of the brain for cortical surface area displays the total surface area for the selected hemisphere(s), while selecting all areas of the brain for cortical thickness displays the mean cortical thickness for the selected hemisphere(s).</li>
</ul>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="phenotype-label" for="phenotype">Phenotype</label>
<div>
<select id="phenotype" class="shiny-input-select"><option value="Cortical Thickness" selected="">Cortical Thickness</option>
<option value="Cortical Surface Area">Cortical Surface Area</option></select>
<script type="application/json" data-for="phenotype" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="hemi-label" for="hemi">Hemisphere</label>
<div>
<select id="hemi" class="shiny-input-select"><option value="left">left</option>
<option value="right">right</option>
<option value="both" selected="">both</option></select>
<script type="application/json" data-for="hemi" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="region-label" for="region">Area of Brain</label>
<div>
<select id="region" class="shiny-input-select"><option value="bankssts">bankssts</option>
<option value="caudal anterior cingulate">caudal anterior cingulate</option>
<option value="caudal middle frontal">caudal middle frontal</option>
<option value="cuneus">cuneus</option>
<option value="entorhinal">entorhinal</option>
<option value="fusiform">fusiform</option>
<option value="inferior parietal">inferior parietal</option>
<option value="inferior temporal">inferior temporal</option>
<option value="isthmus cingulate">isthmus cingulate</option>
<option value="lateral occipital">lateral occipital</option>
<option value="lateral orbitofrontal">lateral orbitofrontal</option>
<option value="lingual">lingual</option>
<option value="medial orbitofrontal">medial orbitofrontal</option>
<option value="middle temporal">middle temporal</option>
<option value="parahippocampal">parahippocampal</option>
<option value="paracentral">paracentral</option>
<option value="pars opercularis">pars opercularis</option>
<option value="pars orbitalis">pars orbitalis</option>
<option value="pars triangularis">pars triangularis</option>
<option value="pericalcarine">pericalcarine</option>
<option value="postcentral">postcentral</option>
<option value="posterior cingulate">posterior cingulate</option>
<option value="precentral">precentral</option>
<option value="precuneus">precuneus</option>
<option value="rostral anterior cingulate">rostral anterior cingulate</option>
<option value="rostral middle frontal">rostral middle frontal</option>
<option value="superior frontal">superior frontal</option>
<option value="superior parietal">superior parietal</option>
<option value="superior temporal">superior temporal</option>
<option value="supramarginal">supramarginal</option>
<option value="frontal pole">frontal pole</option>
<option value="temporal pole">temporal pole</option>
<option value="transverse temporal">transverse temporal</option>
<option value="insula">insula</option>
<option value="all" selected="">all</option></select>
<script type="application/json" data-for="region" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div id="centiles" class="form-group shiny-input-checkboxgroup shiny-input-container" role="group" aria-labelledby="centiles-label">
<label class="control-label" id="centiles-label" for="centiles">Centile Selections</label>
<div class="shiny-options-group">
<div class="checkbox">
<label>
<input type="checkbox" name="centiles" value="0.4">
<span>0.4</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles" value="2">
<span>2</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles" value="2.5" checked="checked">
<span>2.5</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles" value="10">
<span>10</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles" value="25">
<span>25</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles" value="50" checked="checked">
<span>50</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles" value="75">
<span>75</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles" value="90">
<span>90</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles" value="97.5" checked="checked">
<span>97.5</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles" value="98">
<span>98</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles" value="99.6">
<span>99.6</span>
</label>
</div>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="race-label" for="race">Race</label>
<div>
<select id="race" class="shiny-input-select"><option value="All" selected="">All</option>
<option value="White">White</option>
<option value="Hispanic">Hispanic</option>
<option value="Black">Black</option>
<option value="Not Listed">Not Listed</option>
<option value="Asian">Asian</option></select>
<script type="application/json" data-for="race" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="sex-label" for="sex">Sex Assigned at Birth</label>
<div>
<select id="sex" class="shiny-input-select"><option value="Male">Male</option>
<option value="Female" selected="">Female</option></select>
<script type="application/json" data-for="sex" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div></aside>
<button class="collapse-toggle" type="button" title="Toggle sidebar" aria-expanded="true" aria-controls="bslib-sidebar-1">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 16 16" class="bi bi-chevron-left collapse-icon" style="fill:currentColor;" aria-hidden="true" role="img">
      <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"></path>
    </svg>
</button>
<script data-bslib-sidebar-init="">
bslib.Sidebar.initCollapsibleAll()
</script>
</div>
</div>
<div id="spatial-visualization" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container dashboard-sidebar-container" data-orientation="rows" aria-labelledby="tab-spatial-visualization">
<div class="bslib-sidebar-layout html-fill-item html-fill-container" data-bslib-sidebar-open="desktop" data-bslib-sidebar-init="true" style=" --bslib-sidebar-width: 30%"><div class="main html-fill-container html-fill-item"><div class="sidebar-content html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" data-height="100%" style="display: grid; grid-template-rows: minmax(3em, 100fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="shiny-plot-output html-fill-item html-fill-container" id="brainPlot" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
</div>
</div></div><aside id="bslib-sidebar-2" class="sidebar html-fill-container html-fill-item"><div class="html-fill-item html-fill-container">
<p>The Spatial Visualization feature creates visual representations of how centile estimations for brain phenotypes vary throughout regions of the brain.</p>
<ul>
<li>For selected centiles, the raw data option shows you which parts of the cortex are thicker and which have greater surface area.<br>
</li>
<li>The scaled regional max ratio option allows you to more easily see changes over time. Larger numbers indicate more dramatic differences from the regional maximum at that timepoint , while smaller numbers indicate the specific region is closer to the region’s peak value at that timepoint.</li>
</ul>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="statistic-label" for="statistic">What do you want to see?</label>
<div>
<select id="statistic" class="shiny-input-select"><option value="Scaled Regional Max Ratio" selected="">Scaled Regional Max Ratio</option>
<option value="Raw Data">Raw Data</option></select>
<script type="application/json" data-for="statistic" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container no-baseline">
<label class="control-label" id="age_brain-label" for="age_brain">Adolescent Age (months)</label>
<input class="js-range-slider" id="age_brain" data-skin="shiny" data-min="107" data-max="189" data-from="120" data-step="1" data-grid="true" data-grid-num="9.11111111111111" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-keyboard="true" data-data-type="number">
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="phenotype_brain-label" for="phenotype_brain">Phenotype</label>
<div>
<select id="phenotype_brain" class="shiny-input-select"><option value="Cortical Thickness" selected="">Cortical Thickness</option>
<option value="Cortical Surface Area">Cortical Surface Area</option></select>
<script type="application/json" data-for="phenotype_brain" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div id="centiles_brain" class="form-group shiny-input-checkboxgroup shiny-input-container" role="group" aria-labelledby="centiles_brain-label">
<label class="control-label" id="centiles_brain-label" for="centiles_brain">Centile Selections</label>
<div class="shiny-options-group">
<div class="checkbox">
<label>
<input type="checkbox" name="centiles_brain" value="0.4">
<span>0.4</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles_brain" value="2">
<span>2</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles_brain" value="2.5" checked="checked">
<span>2.5</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles_brain" value="10">
<span>10</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles_brain" value="25">
<span>25</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles_brain" value="50" checked="checked">
<span>50</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles_brain" value="75">
<span>75</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles_brain" value="90">
<span>90</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles_brain" value="97.5" checked="checked">
<span>97.5</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles_brain" value="98">
<span>98</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="centiles_brain" value="99.6">
<span>99.6</span>
</label>
</div>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="race_brain-label" for="race_brain">Race</label>
<div>
<select id="race_brain" class="shiny-input-select"><option value="All" selected="">All</option>
<option value="White">White</option>
<option value="Hispanic">Hispanic</option>
<option value="Black">Black</option>
<option value="Not Listed">Not Listed</option>
<option value="Asian">Asian</option></select>
<script type="application/json" data-for="race_brain" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="sex_brain-label" for="sex_brain">Sex Assigned at Birth</label>
<div>
<select id="sex_brain" class="shiny-input-select"><option value="Male">Male</option>
<option value="Female" selected="">Female</option></select>
<script type="application/json" data-for="sex_brain" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="hemi_brain-label" for="hemi_brain">Hemisphere</label>
<div>
<select id="hemi_brain" class="shiny-input-select"><option value="left">left</option>
<option value="right">right</option>
<option value="Both" selected="">Both</option></select>
<script type="application/json" data-for="hemi_brain" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div></aside>
<button class="collapse-toggle" type="button" title="Toggle sidebar" aria-expanded="true" aria-controls="bslib-sidebar-2">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 16 16" class="bi bi-chevron-left collapse-icon" style="fill:currentColor;" aria-hidden="true" role="img">
      <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"></path>
    </svg>
</button>
<script data-bslib-sidebar-init="">
bslib.Sidebar.initCollapsibleAll()
</script>
</div>
</div>
<div id="cortical-thickness" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container" data-orientation="rows" aria-labelledby="tab-cortical-thickness">
<div class="html-fill-item html-fill-container dashboard-toolbar-container"><div class="toolbar html-fill-container" data-layout="flow">
<p>The Cortical Thickness centile plot feature allows for side-by-side comparison of estimated centiles for cortical thickness for selected brain region and demographics.</p>
<div>

</div>
<div class="cell quarto-layout-panel" title="Select Options" data-layout-nrow="2" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="form-group shiny-input-container">
<label class="control-label" id="thickness_var-label" for="thickness_var">Select area of brain to model cortical thickness: </label>
<div>
<select id="thickness_var" class="shiny-input-select"><option value=" left Hemisphere Banks of Superior Temporal Sulcus"> left Hemisphere Banks of Superior Temporal Sulcus</option>
<option value=" left Hemisphere caudalanteriorcingulate"> left Hemisphere caudalanteriorcingulate</option>
<option value=" left Hemisphere caudalmiddlefrontal"> left Hemisphere caudalmiddlefrontal</option>
<option value=" left Hemisphere cuneus"> left Hemisphere cuneus</option>
<option value=" left Hemisphere entorhinal"> left Hemisphere entorhinal</option>
<option value=" left Hemisphere fusiform"> left Hemisphere fusiform</option>
<option value=" left Hemisphere inferiorparietal"> left Hemisphere inferiorparietal</option>
<option value=" left Hemisphere inferiortemporal"> left Hemisphere inferiortemporal</option>
<option value=" left Hemisphere isthmuscingulate"> left Hemisphere isthmuscingulate</option>
<option value=" left Hemisphere lateraloccipital"> left Hemisphere lateraloccipital</option>
<option value=" left Hemisphere lateralorbitofrontal"> left Hemisphere lateralorbitofrontal</option>
<option value=" left Hemisphere lingual"> left Hemisphere lingual</option>
<option value=" left Hemisphere medialorbitofrontal"> left Hemisphere medialorbitofrontal</option>
<option value=" left Hemisphere middletemporal"> left Hemisphere middletemporal</option>
<option value=" left Hemisphere parahippocampal"> left Hemisphere parahippocampal</option>
<option value=" left Hemisphere paracentral"> left Hemisphere paracentral</option>
<option value=" left Hemisphere parsopercularis"> left Hemisphere parsopercularis</option>
<option value=" left Hemisphere parsorbitalis"> left Hemisphere parsorbitalis</option>
<option value=" left Hemisphere parstriangularis"> left Hemisphere parstriangularis</option>
<option value=" left Hemisphere pericalcarine"> left Hemisphere pericalcarine</option>
<option value=" left Hemisphere postcentral"> left Hemisphere postcentral</option>
<option value=" left Hemisphere posteriorcingulate"> left Hemisphere posteriorcingulate</option>
<option value=" left Hemisphere precentral"> left Hemisphere precentral</option>
<option value=" left Hemisphere precuneus"> left Hemisphere precuneus</option>
<option value=" left Hemisphere rostralanteriorcingulate"> left Hemisphere rostralanteriorcingulate</option>
<option value=" left Hemisphere rostralmiddlefrontal"> left Hemisphere rostralmiddlefrontal</option>
<option value=" left Hemisphere superiorfrontal"> left Hemisphere superiorfrontal</option>
<option value=" left Hemisphere superiorparietal"> left Hemisphere superiorparietal</option>
<option value=" left Hemisphere superiortemporal"> left Hemisphere superiortemporal</option>
<option value=" left Hemisphere supramarginal"> left Hemisphere supramarginal</option>
<option value=" left Hemisphere frontalpole"> left Hemisphere frontalpole</option>
<option value=" left Hemisphere temporalpole"> left Hemisphere temporalpole</option>
<option value=" left Hemisphere transversetemporal"> left Hemisphere transversetemporal</option>
<option value=" left Hemisphere insula"> left Hemisphere insula</option>
<option value=" right Hemisphere Banks of Superior Temporal Sulcus"> right Hemisphere Banks of Superior Temporal Sulcus</option>
<option value=" right Hemisphere caudalanteriorcingulate"> right Hemisphere caudalanteriorcingulate</option>
<option value=" right Hemisphere caudalmiddlefrontal"> right Hemisphere caudalmiddlefrontal</option>
<option value=" right Hemisphere cuneus"> right Hemisphere cuneus</option>
<option value=" right Hemisphere entorhinal"> right Hemisphere entorhinal</option>
<option value=" right Hemisphere fusiform"> right Hemisphere fusiform</option>
<option value=" right Hemisphere inferiorparietal"> right Hemisphere inferiorparietal</option>
<option value=" right Hemisphere inferiortemporal"> right Hemisphere inferiortemporal</option>
<option value=" right Hemisphere isthmuscingulate"> right Hemisphere isthmuscingulate</option>
<option value=" right Hemisphere lateraloccipital"> right Hemisphere lateraloccipital</option>
<option value=" right Hemisphere lateralorbitofrontal"> right Hemisphere lateralorbitofrontal</option>
<option value=" right Hemisphere lingual"> right Hemisphere lingual</option>
<option value=" right Hemisphere medialorbitofrontal"> right Hemisphere medialorbitofrontal</option>
<option value=" right Hemisphere middletemporal"> right Hemisphere middletemporal</option>
<option value=" right Hemisphere parahippocampal"> right Hemisphere parahippocampal</option>
<option value=" right Hemisphere paracentral"> right Hemisphere paracentral</option>
<option value=" right Hemisphere parsopercularis"> right Hemisphere parsopercularis</option>
<option value=" right Hemisphere parsorbitalis"> right Hemisphere parsorbitalis</option>
<option value=" right Hemisphere parstriangularis"> right Hemisphere parstriangularis</option>
<option value=" right Hemisphere pericalcarine"> right Hemisphere pericalcarine</option>
<option value=" right Hemisphere postcentral"> right Hemisphere postcentral</option>
<option value=" right Hemisphere posteriorcingulate"> right Hemisphere posteriorcingulate</option>
<option value=" right Hemisphere precentral"> right Hemisphere precentral</option>
<option value=" right Hemisphere precuneus"> right Hemisphere precuneus</option>
<option value=" right Hemisphere rostralanteriorcingulate"> right Hemisphere rostralanteriorcingulate</option>
<option value=" right Hemisphere rostralmiddlefrontal"> right Hemisphere rostralmiddlefrontal</option>
<option value=" right Hemisphere superiorfrontal"> right Hemisphere superiorfrontal</option>
<option value=" right Hemisphere superiorparietal"> right Hemisphere superiorparietal</option>
<option value=" right Hemisphere superiortemporal"> right Hemisphere superiortemporal</option>
<option value=" right Hemisphere supramarginal"> right Hemisphere supramarginal</option>
<option value=" right Hemisphere frontalpole"> right Hemisphere frontalpole</option>
<option value=" right Hemisphere temporalpole"> right Hemisphere temporalpole</option>
<option value=" right Hemisphere transversetemporal"> right Hemisphere transversetemporal</option>
<option value=" right Hemisphere insula"> right Hemisphere insula</option>
<option value="left hemisphere">left hemisphere</option>
<option value="right hemisphere">right hemisphere</option>
<option value="whole brain" selected="">whole brain</option></select>
<script type="application/json" data-for="thickness_var" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="centiles_thickness" class="form-group shiny-input-checkboxgroup shiny-input-container shiny-input-container-inline" role="group" aria-labelledby="centiles_thickness-label">
<label class="control-label" id="centiles_thickness-label" for="centiles_thickness">Select Centiles to Include in Plot</label>
<div class="shiny-options-group">
<label class="checkbox-inline">
<input type="checkbox" name="centiles_thickness" value="0.4">
<span>0.4</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_thickness" value="2">
<span>2</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_thickness" value="2.5" checked="checked">
<span>2.5</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_thickness" value="10">
<span>10</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_thickness" value="25">
<span>25</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_thickness" value="50" checked="checked">
<span>50</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_thickness" value="75">
<span>75</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_thickness" value="90">
<span>90</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_thickness" value="97.5" checked="checked">
<span>97.5</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_thickness" value="98">
<span>98</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_thickness" value="99.6">
<span>99.6</span>
</label>
</div>
</div>
</div>
</div>
</div>
</div><div class="toolbar-content html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 100fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Plot 1" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-toolbar html-fill-item html-fill-container" data-target-position="header" data-target-element="next"><div class="card-title html-fill-item html-fill-container">Plot 1</div>
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div class="form-group shiny-input-container html-fill-item html-fill-container">
<label class="control-label" id="race3-label" for="race3">Race</label>
<div class="html-fill-item html-fill-container">
<select id="race3" class="shiny-input-select"><option value="All" selected="">All</option>
<option value="White">White</option>
<option value="Hispanic">Hispanic</option>
<option value="Black">Black</option>
<option value="Not Listed">Not Listed</option>
<option value="Asian">Asian</option></select>
<script type="application/json" data-for="race3" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div class="form-group shiny-input-container html-fill-item html-fill-container">
<label class="control-label" id="sex3-label" for="sex3">Sex Assigned at Birth</label>
<div class="html-fill-item html-fill-container">
<select id="sex3" class="shiny-input-select"><option value="Male">Male</option>
<option value="Female" selected="">Female</option></select>
<script type="application/json" data-for="sex3" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div>
</div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="shiny-plot-output html-fill-item html-fill-container" id="thick_centile_plot_1" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-title="Plot 2" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-toolbar html-fill-item html-fill-container" data-target-position="header" data-target-element="next"><div class="card-title html-fill-item html-fill-container">Plot 2</div>
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div class="form-group shiny-input-container html-fill-item html-fill-container">
<label class="control-label" id="race4-label" for="race4">Race</label>
<div class="html-fill-item html-fill-container">
<select id="race4" class="shiny-input-select"><option value="All" selected="">All</option>
<option value="White">White</option>
<option value="Hispanic">Hispanic</option>
<option value="Black">Black</option>
<option value="Not Listed">Not Listed</option>
<option value="Asian">Asian</option></select>
<script type="application/json" data-for="race4" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div class="form-group shiny-input-container html-fill-item html-fill-container">
<label class="control-label" id="sex4-label" for="sex4">Sex Assigned at Birth</label>
<div class="html-fill-item html-fill-container">
<select id="sex4" class="shiny-input-select"><option value="Male" selected="">Male</option>
<option value="Female">Female</option></select>
<script type="application/json" data-for="sex4" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div>
</div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="shiny-plot-output html-fill-item html-fill-container" id="thick_centile_plot_2" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
</div></div>
</div>
<div id="cortical-surface-area" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container" data-orientation="rows" aria-labelledby="tab-cortical-surface-area">
<div class="html-fill-item html-fill-container dashboard-toolbar-container"><div class="toolbar html-fill-container" data-layout="flow">
<p>The Cortical Surface Area centile plot feature allows for side-by-side comparison of estimated centiles for cortical thickness for selected brain region and demographics.</p>
<div>

</div>
<div class="cell quarto-layout-panel" title="Select Options" data-layout-nrow="2" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="form-group shiny-input-container">
<label class="control-label" id="area_var-label" for="area_var">Select area of brain to model cortical surface area: </label>
<div>
<select id="area_var" class="shiny-input-select"><option value="left hemisphere banks of superior temporal sulcus">left hemisphere banks of superior temporal sulcus</option>
<option value="left hemisphere caudalanteriorcingulate">left hemisphere caudalanteriorcingulate</option>
<option value="left hemisphere caudalmiddlefrontal">left hemisphere caudalmiddlefrontal</option>
<option value="left hemisphere cuneus">left hemisphere cuneus</option>
<option value="left hemisphere entorhinal">left hemisphere entorhinal</option>
<option value="left hemisphere fusiform">left hemisphere fusiform</option>
<option value="left hemisphere inferiorparietal">left hemisphere inferiorparietal</option>
<option value="left hemisphere inferiortemporal">left hemisphere inferiortemporal</option>
<option value="left hemisphere isthmuscingulate">left hemisphere isthmuscingulate</option>
<option value="left hemisphere lateraloccipital">left hemisphere lateraloccipital</option>
<option value="left hemisphere lateralorbitofrontal">left hemisphere lateralorbitofrontal</option>
<option value="left hemisphere lingual">left hemisphere lingual</option>
<option value="left hemisphere medialorbitofrontal">left hemisphere medialorbitofrontal</option>
<option value="left hemisphere middletemporal">left hemisphere middletemporal</option>
<option value="left hemisphere parahippocampal">left hemisphere parahippocampal</option>
<option value="left hemisphere paracentral">left hemisphere paracentral</option>
<option value="left hemisphere parsopercularis">left hemisphere parsopercularis</option>
<option value="left hemisphere parsorbitalis">left hemisphere parsorbitalis</option>
<option value="left hemisphere parstriangularis">left hemisphere parstriangularis</option>
<option value="left hemisphere pericalcarine">left hemisphere pericalcarine</option>
<option value="left hemisphere postcentral">left hemisphere postcentral</option>
<option value="left hemisphere posteriorcingulate">left hemisphere posteriorcingulate</option>
<option value="left hemisphere precentral">left hemisphere precentral</option>
<option value="left hemisphere precuneus">left hemisphere precuneus</option>
<option value="left hemisphere rostralanteriorcingulate">left hemisphere rostralanteriorcingulate</option>
<option value="left hemisphere rostralmiddlefrontal">left hemisphere rostralmiddlefrontal</option>
<option value="left hemisphere superiorfrontal">left hemisphere superiorfrontal</option>
<option value="left hemisphere superiorparietal">left hemisphere superiorparietal</option>
<option value="left hemisphere superiortemporal">left hemisphere superiortemporal</option>
<option value="left hemisphere supramarginal">left hemisphere supramarginal</option>
<option value="left hemisphere frontalpole">left hemisphere frontalpole</option>
<option value="left hemisphere temporalpole">left hemisphere temporalpole</option>
<option value="left hemisphere transversetemporal">left hemisphere transversetemporal</option>
<option value="left hemisphere insula">left hemisphere insula</option>
<option value="right hemisphere banks of superior temporal sulcus">right hemisphere banks of superior temporal sulcus</option>
<option value="right hemisphere caudalanteriorcingulate">right hemisphere caudalanteriorcingulate</option>
<option value="right hemisphere caudalmiddlefrontal">right hemisphere caudalmiddlefrontal</option>
<option value="right hemisphere cuneus">right hemisphere cuneus</option>
<option value="right hemisphere entorhinal">right hemisphere entorhinal</option>
<option value="right hemisphere fusiform">right hemisphere fusiform</option>
<option value="right hemisphere inferiorparietal">right hemisphere inferiorparietal</option>
<option value="right hemisphere inferiortemporal">right hemisphere inferiortemporal</option>
<option value="right hemisphere isthmuscingulate">right hemisphere isthmuscingulate</option>
<option value="right hemisphere lateraloccipital">right hemisphere lateraloccipital</option>
<option value="right hemisphere lateralorbitofrontal">right hemisphere lateralorbitofrontal</option>
<option value="right hemisphere lingual">right hemisphere lingual</option>
<option value="right hemisphere medialorbitofrontal">right hemisphere medialorbitofrontal</option>
<option value="right hemisphere middletemporal">right hemisphere middletemporal</option>
<option value="right hemisphere parahippocampal">right hemisphere parahippocampal</option>
<option value="right hemisphere paracentral">right hemisphere paracentral</option>
<option value="right hemisphere parsopercularis">right hemisphere parsopercularis</option>
<option value="right hemisphere parsorbitalis">right hemisphere parsorbitalis</option>
<option value="right hemisphere parstriangularis">right hemisphere parstriangularis</option>
<option value="right hemisphere pericalcarine">right hemisphere pericalcarine</option>
<option value="right hemisphere postcentral">right hemisphere postcentral</option>
<option value="right hemisphere posteriorcingulate">right hemisphere posteriorcingulate</option>
<option value="right hemisphere precentral">right hemisphere precentral</option>
<option value="right hemisphere precuneus">right hemisphere precuneus</option>
<option value="right hemisphere rostralanteriorcingulate">right hemisphere rostralanteriorcingulate</option>
<option value="right hemisphere rostralmiddlefrontal">right hemisphere rostralmiddlefrontal</option>
<option value="right hemisphere superiorfrontal">right hemisphere superiorfrontal</option>
<option value="right hemisphere superiorparietal">right hemisphere superiorparietal</option>
<option value="right hemisphere superiortemporal">right hemisphere superiortemporal</option>
<option value="right hemisphere supramarginal">right hemisphere supramarginal</option>
<option value="right hemisphere frontalpole">right hemisphere frontalpole</option>
<option value="right hemisphere temporalpole">right hemisphere temporalpole</option>
<option value="right hemisphere transversetemporal">right hemisphere transversetemporal</option>
<option value="right hemisphere insula">right hemisphere insula</option>
<option value="left hemisphere ">left hemisphere </option>
<option value="right hemisphere ">right hemisphere </option>
<option value="whole brain " selected="">whole brain </option></select>
<script type="application/json" data-for="area_var" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="centiles_area" class="form-group shiny-input-checkboxgroup shiny-input-container shiny-input-container-inline" role="group" aria-labelledby="centiles_area-label">
<label class="control-label" id="centiles_area-label" for="centiles_area">Select Centiles to Include in Plot</label>
<div class="shiny-options-group">
<label class="checkbox-inline">
<input type="checkbox" name="centiles_area" value="0.4">
<span>0.4</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_area" value="2">
<span>2</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_area" value="2.5" checked="checked">
<span>2.5</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_area" value="10">
<span>10</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_area" value="25">
<span>25</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_area" value="50" checked="checked">
<span>50</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_area" value="75">
<span>75</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_area" value="90">
<span>90</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_area" value="97.5" checked="checked">
<span>97.5</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_area" value="98">
<span>98</span>
</label>
<label class="checkbox-inline">
<input type="checkbox" name="centiles_area" value="99.6">
<span>99.6</span>
</label>
</div>
</div>
</div>
</div>
</div>
</div><div class="toolbar-content html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 100fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Plot 1" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-toolbar html-fill-item html-fill-container" data-target-position="header" data-target-element="next"><div class="card-title html-fill-item html-fill-container">Plot 1</div>
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div class="form-group shiny-input-container html-fill-item html-fill-container">
<label class="control-label" id="race1-label" for="race1">Race</label>
<div class="html-fill-item html-fill-container">
<select id="race1" class="shiny-input-select"><option value="All" selected="">All</option>
<option value="White">White</option>
<option value="Hispanic">Hispanic</option>
<option value="Black">Black</option>
<option value="Not Listed">Not Listed</option>
<option value="Asian">Asian</option></select>
<script type="application/json" data-for="race1" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div class="form-group shiny-input-container html-fill-item html-fill-container">
<label class="control-label" id="sex1-label" for="sex1">Sex Assigned at Birth</label>
<div class="html-fill-item html-fill-container">
<select id="sex1" class="shiny-input-select"><option value="Male">Male</option>
<option value="Female" selected="">Female</option></select>
<script type="application/json" data-for="sex1" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div>
</div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="shiny-plot-output html-fill-item html-fill-container" id="area_centile_plot_1" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-title="Plot 2" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-toolbar html-fill-item html-fill-container" data-target-position="header" data-target-element="next"><div class="card-title html-fill-item html-fill-container">Plot 2</div>
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div class="form-group shiny-input-container html-fill-item html-fill-container">
<label class="control-label" id="race2-label" for="race2">Race</label>
<div class="html-fill-item html-fill-container">
<select id="race2" class="shiny-input-select"><option value="All" selected="">All</option>
<option value="White">White</option>
<option value="Hispanic">Hispanic</option>
<option value="Black">Black</option>
<option value="Not Listed">Not Listed</option>
<option value="Asian">Asian</option></select>
<script type="application/json" data-for="race2" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div class="form-group shiny-input-container html-fill-item html-fill-container">
<label class="control-label" id="sex2-label" for="sex2">Sex Assigned at Birth</label>
<div class="html-fill-item html-fill-container">
<select id="sex2" class="shiny-input-select"><option value="Male" selected="">Male</option>
<option value="Female">Female</option></select>
<script type="application/json" data-for="sex2" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div>
</div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="shiny-plot-output html-fill-item html-fill-container" id="area_centile_plot_2" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
</div></div>
</div>
<div id="about-us" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container" data-orientation="rows" aria-labelledby="tab-about-us">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr) minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card html-fill-item html-fill-container bslib-card" data-title="About Us" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title">About Us</div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="h4">
Shelby

Tisdale
</div>
<p>Shelby is a senior at Duke University studying Statistics, Math Education, and Child Policy. She is from Mississippi originally, and still can’t get over the lack of extreme summer heat and humidity in the Twin Cities! When she isn’t enforcing “tidyverse style guidelines,” Shelby likes to crochet, pretend to enjoy video games, and meal plan.</p>
<p><strong>GitHub</strong>: <a href="https://github.com/shelby-tisdale" class="uri">https://github.com/shelby-tisdale</a></p>
<p><strong>Email</strong>: <a href="shelby.tisdale@duke.edu">shelby.tisdale@duke.edu</a></p>
<div class="h4">
Nichole

Zhang
</div>
<p>Nichole is a senior at Duke University studying Statistics and International Comparative Studies, but most people don’t know what that is, so she says she studies History. She is from Chapel Hill, North Carolina and visualized hundreds of brains in the process of developing this app. She’s spent her time in the Twin Cities this summer learning to rock climb and crossing locations off her map of independent bookstores to visit in the Midwest.</p>
<p><strong>Email</strong>: <a href="nichole.zhang@duke.edu">nichole.zhang@duke.edu</a></p>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card html-fill-item html-fill-container bslib-card" data-title="Acknowledgements" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title">Acknowledgements</div></div>
<div class="card-body html-fill-item html-fill-container">
<p>We are grateful to Dr.&nbsp;Mark Fiecas for advising this project and directing the 2024 Equitable Data Science in Adolescent Development REU at the University of Minnesota – Twin Cities, to all guest speakers, hackathon hosts, and partners from the UMN School of Public Health and beyond, to David Schneck for teaching our summer R course, and the National Science Foundation for making this program and project possible.</p>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div id="3ade8a4a-fb1d-4a6c-8409-ac45482d5fc9" class="hidden html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
</div>
<p>
<script type="application/shiny-prerendered" data-context="server-start">
# load all necessary packages
library(tidyverse)
library(gt)
library(DT)
library(janitor)
library(shiny)
library(knitr)
library(kableExtra)
library(scales)
library(extrafont)
library(gamlss)
library(gamlss.ggplots)
library(plotly)
library(latex2exp)
library(ggseg)
library(patchwork)
library(gtsummary)
library(rlist)
library(grid)
library(gridExtra)
library(viridis)
library(ggseg3d)
library(ggpubr)
library(lubridate)

# set theme for visualizations
theme_set(theme_minimal(base_size = 16, base_family = "Atkinson Hyperlegible"))
</script>
 
<script type="application/shiny-prerendered" data-context="data">
# labels for cortical surface area variables
# from ABCD data dictionary
area_labels <- read_csv(
  "additional data/Area_Variable_Labels.csv"
  ) |>
  # clean labels
  mutate(var_label = str_replace(var_label, "Cortical area in mm\\^", ""),
         var_label = str_replace(var_label, "2 of APARC ROI ", ""),
         var_label = str_replace(var_label, "lh-", "Left Hemisphere "),
         var_label = str_replace(var_label, "rh-", "Right Hemisphere "),
         var_label = str_replace(var_label, "cortical area in mm\\^2", ""),
         var_label = str_replace(var_label, "Total ", ""),
         var_label = str_to_lower(var_label))# |>
  # arrange in alphabetical order
 # arrange(var_label)

# save area labels as vector
area_vars <- area_labels$var_label
</script>
 
<script type="application/shiny-prerendered" data-context="data">
thickness_labels <- read_csv(
  "additional data/Thickness_Variable_Labels.csv"
  ) |>
  mutate(var_label = str_remove_all(var_label, "Cortical thickness in mm of APARC ROI"),
         var_label = str_replace(var_label, "lh-", "left Hemisphere "),
         var_label = str_replace(var_label, "rh-", "right Hemisphere "),
         var_label = str_remove_all(var_label, "Mean cortical thickness in mm for "),
         var_label = str_remove_all(var_label, "Mean cortical thickness in mm "))

# save thickness labels as vector
thick_vars <- thickness_labels$var_label
</script>
 
<script type="application/shiny-prerendered" data-context="data">
# specify ABCD data directory
data_dir <- 'C:/Users/queen/Box/ABCD Tabulated Data/5.1/core/'

# NOTE: must run entire code chunk
if (!is.null(data_dir)) {
  setwd(data_dir)
}

# LOAD DATA
# Demographic variables and propensity weights
demog <- read.csv("abcd-general/abcd_p_demo.csv", na.strings = c("999", "777"))
# Age in months, Site ID (ABCD Study Design Variables), Family ID
study_covars <- read.csv("abcd-general/abcd_y_lt.csv")
# desikan atlas, cortical thickness
dat.mri = read.csv('imaging/mri_y_smr_thk_dsk.csv')
# desikan atlas, cortical surface area
dat.mri.area = read.csv('imaging/mri_y_smr_area_dsk.csv') #|>
  #select(src_subject_id, eventname, smri_area_cdk_total)
</script>
 
<script type="application/shiny-prerendered" data-context="data">
# basic cleaning for demographic variables
demog_clean <- demog |>
  # filter for events of interest
  filter(eventname %in% c("baseline_year_1_arm_1", "2_year_follow_up_y_arm_1",
                          "4_year_follow_up_y_arm_1")) |>
  # select broad demographics
  select(src_subject_id, eventname, starts_with("demo_brthdat_v2"), demo_sex_v2,
         race_ethnicity) |>
  mutate(
    # clean age variable
    age = case_when(
      eventname == "baseline_year_1_arm_1" ~ trunc(demo_brthdat_v2),
      eventname %in% c(
        "2_year_follow_up_y_arm_1", "4_year_follow_up_y_arm_1"
        ) ~ trunc(demo_brthdat_v2_l)),
    # broad race/ethnicity categories
    # will disaggregate in final analysis
    race_ethnicity = case_match(
      race_ethnicity,
      1 ~ "White",
      2 ~ "Black",
      3 ~ "Hispanic",
      4 ~ "Asian",
      5 ~ "Not Listed"
    ),
    # recode sex variable
    sex = factor(demo_sex_v2),
    sex = fct_recode(
      sex,
      "Male" = "1",
      "Female" = "2",
      "Intersex-Male" = "3"
    ))
</script>
 
<script type="application/shiny-prerendered" data-context="data">
# create dataset for modeling
mri_data <- dat.mri |>
  full_join(dat.mri.area, by = join_by("eventname", "src_subject_id")) |>
  # join mri data to demographics
  right_join(demog_clean, by = join_by("eventname", "src_subject_id")) |>
  # join to study covariates
  left_join(study_covars, by = join_by("eventname", "src_subject_id")) |>
  # select variables of interest
  select(src_subject_id, eventname, age, sex, site_id_l, race_ethnicity,
         interview_age, contains("smri_thick"), contains("smri_area_cdk")) |>
  # remove irrelevant ages 
  filter(age < 16 & age > 8) |>
  mutate(interview_age = as.numeric(interview_age)) |>
  group_by(src_subject_id) |>
  drop_na(smri_thick_cdk_mean, smri_area_cdk_total) |>
  # fill repeated demographic values
  mutate(sex = first(na.omit(sex)),
         race_ethnicity = first(na.omit(race_ethnicity)),
         src_subject_id = factor(src_subject_id),
         site_id_l = factor(site_id_l),
         race_ethnicity = factor(race_ethnicity)) |>
  ungroup()
</script>
 
<script type="application/shiny-prerendered" data-context="data">
# dataset to be subsetted for models
brain_data <- mri_data |>
  # na.omit(mri_data) |>
  filter(sex != "Intersex-Male") |>
  mutate(sex = factor(sex),
         race_ethnicity = if_else(
           race_ethnicity == "Other", "Not Listed", race_ethnicity))
</script>
 
<script type="application/shiny-prerendered" data-context="data">
# find all combinations of race and sex
demog_combos <- brain_data |>
  mutate(race_ethnicity = as.character(race_ethnicity),
         sex = factor(sex)) |>
  expand(sex, race_ethnicity) |>
  na.omit()

# create vectors to add "All" race category
male_all <- c("Male", "All")
female_all <- c("Female", "All")

# add "All" category to combinations
demog_combos <- rbind(demog_combos, male_all, female_all)

# find y axis limits for area variables
limits_area <- brain_data |> pivot_longer(
  cols = starts_with("smri_area"),
  names_to = "var_name",
  values_to = "values"
) |>
  group_by(var_name) |>
  summarize(
    min_value = mean(values) - 4*sd(values),
    max_value = mean(values) + 4*sd(values)
  )

# find y axis limits for thickness variables
limits_thick <- brain_data |> pivot_longer(
  cols = starts_with("smri_thick"),
  names_to = "var_name",
  values_to = "values"
) |>
  group_by(var_name) |>
  summarize(
    min_value = mean(values) - 4*sd(values),
    max_value = mean(values) + 4*sd(values)
  )

# demographic combinations matrix for area variables
demog_brain_combos_area <- expand.grid(
  sex = demog_combos$sex,
  race_ethnicity = demog_combos$race_ethnicity,
  brain_location = area_vars) |>
  distinct() |>
  left_join(area_labels, by = join_by(brain_location == var_label)) |>
  left_join(limits_area, by = join_by(var_name)) |>
  mutate(sex = factor(sex),
         race_ethnicity = factor(race_ethnicity),
         brain_location = factor(brain_location),
         min_value = as.numeric(min_value),
         max_value = as.numeric(max_value)) |>
  as.matrix()

# demographic combinations matrix for thickness variables
demog_brain_combos_thick <- expand.grid(
  sex = demog_combos$sex,
  race_ethnicity = demog_combos$race_ethnicity,
  brain_location = thickness_labels$var_name) |>
  distinct() |>
  left_join(thickness_labels, by = join_by(brain_location == var_name)) |>
  left_join(limits_thick, by = join_by(brain_location == var_name)) |>
  mutate(sex = factor(sex),
         race_ethnicity = factor(race_ethnicity),
         brain_location = factor(brain_location),
         min_value = as.numeric(min_value),
         max_value = as.numeric(max_value)) |>
  select(sex, race_ethnicity, brain_location, var_label, min_value,
         max_value) |>
  as.matrix()
</script>
 
<script type="application/shiny-prerendered" data-context="server-start">
# SUBSETS DATA BY FILTERING FOR UP TO 2 VARIABLES
# PREPS DATA FOR MODELING
# EX. SEX = "MALE" AND RACE = "BLACK"
subset_data <- function(
    # full data set
    brain_data,
    # x variable
    xcol,
    # y variable
    ycol,
    # first variable to filter by
    filter_var1 = NULL,
    # value of first variable to filter for
    filter_val1 = NULL,
    # second variable to filter by
    filter_var2 = NULL,
    # value of second variable to filter for
    filter_val2 = NULL
) {
  
  # removes underrepresented sex and omits NA values
  brain_data <- brain_data |>
    filter(sex != "Intersex-Male") |>
    mutate(sex = factor(sex)) |>
    na.omit()
  
  if (filter_val2 == "All") {
    filter_var2 = NULL
    filter_val2 = NULL
  }
  
    # subset data
  if (!is.null(filter_var1) & !is.null(filter_val1) & is.null(filter_var2) & is.null(filter_var2)) {
    data_subset <- subset(
      brain_data, brain_data[[filter_var1]] == filter_val1)
  }
  if (!is.null(filter_var2) & !is.null(filter_var2)) {
    data_subset <- subset(
      brain_data, brain_data[[filter_var1]] == filter_val1 & brain_data[[filter_var2]] == filter_val2)
    
  }
  if (is.null(filter_var1) & is.null(filter_val1) & is.null(filter_var2) & is.null(filter_var2)) {
    data_subset <- brain_data
  }
  
  # creates x variable and y variable columns in data set
  data_subset$xvar <- data_subset[[xcol]]
  data_subset$yvar <- data_subset[[ycol]]
  
  return(data_subset)
}
</script>
 
<script type="application/shiny-prerendered" data-context="server-start">
# Takes output of subset_data() function as argument
area_model <- function(data_subset) {
  
  # finds power transformation for gamlss model
  power <- gamlss::findPower(yvar, xvar, data = data_subset, k = 2)
  
  # build GAMLSS model for subset data
  model <- gamlss(
  yvar ~ pb(xvar^power) + gamlss::random(src_subject_id) + gamlss::random(site_id_l),
  sigma.formula = ~pb(xvar),
  tau.formula = ~xvar,
  nu.formula = ~xvar,
  family = BCPEo,
  data = data_subset
  )

  return(model)
}

</script>
 
<script type="application/shiny-prerendered" data-context="server-start">
# creates data frame of centiles for a given model object
# model_data *MUST* be the same data used to build model object
calculate_centiles <- function(
  # GAMLSS model object
  model,
  # data used to build model
  model_data,
  # x variable in model_data
  xcol,
  # y variable in model_data
  ycol,
  # centiles to calculate
  cent = c(97.5, 50, 2.5)
) {
  
xvar_ch <- deparse(xcol)
yvar_ch <- ycol
obj = model
x <- y <- NULL

xvar  <- get(xvar_ch, envir = as.environment(model_data))
fname <- obj$family[1]
qfun <- paste("q",fname,sep = "")
oxvar <- xvar[order(xvar)]
oyvar <- obj$y[order(xvar)]

lpar <- 4

ii <- 0
per <- rep(0, length(cent))
centile_matrix <- matrix(0, ncol = length(cent), nrow = dim(model_data)[1])
colnames(centile_matrix) <- cent

for (var in cent) {
  newcall <- call(qfun, var/100,
                  mu = fitted(obj,"mu")[order(xvar)],
                  sigma = fitted(obj,"sigma")[order(xvar)],
                  nu = fitted(obj,"nu")[order(xvar)],
                  tau = fitted(obj,"tau")[order(xvar)]) 
    ii <- ii + 1
    centile_matrix[,ii] <- eval(newcall)
}

lc <- length(cent)
centile_data <- data.frame(
  centile = centile_matrix,
  x = oxvar,
  y = oyvar)

return(centile_data)
}
</script>
 
<script type="application/shiny-prerendered" data-context="data">
setwd("~/Equitable Data Science REU/distributional-models")
centiles_list_area <- read_rds("centiles_data_area.rds")
centiles_list_thick <- read_rds("centiles_data_thick.rds")
</script>
 
<script type="application/shiny-prerendered" data-context="server-start">
# returns ggplot for given model and data used to create model
centiles_plot <- function(
    cur_index,
    # x variable in data
    xcol,
    # y variable in data
    cur_ycol,
    cent = c(2.5, 50, 97.5),
    # whether to include points on plot in addition to centile curves
    points = TRUE,
    race_input = "",
    sex_input = "",
    ylims = c(125000, 250000),
    region_input = "Total Brain"
    ) {

  model_data <- subset_data(
    brain_data,
    xcol = "interview_age",
    ycol = cur_ycol,
    filter_var1 = "sex",
    filter_val1 = demog_brain_combos_area[cur_index, 1],
    filter_var2 = "race_ethnicity",
    filter_val2 = demog_brain_combos_area[cur_index, 2])
  
  centile_data <- centiles_list_area[[cur_index]]
  
  data_centiles <- as.numeric(str_replace(colnames(centile_data), "centile.", "")[1:11])
  cent_cols <- names(centile_data)[data_centiles %in% cent]
  centile_data <- centile_data |>
    select(all_of(cent_cols), x)
  
  lc <- length(cent)
  c_names <- colnames(centile_data)
  line.size = 1.5
  line.col = hcl.colors(lc, palette = "Dark 2")
  line.type = rep(1, length(cent))
  
  # initialize ggplot object
  gg <- ggplot(data = centile_data)
  
  if (points == TRUE) {
    gg <- gg + geom_point(data = model_data, aes(x = xvar, y = yvar),
             size = 1, alpha = 0.2, show.legend = FALSE, color = "gray")
  }
  for (i in 1:lc) {
    
    if (c_names[i] == "centile.50") {
      gg <- gg +
      geom_line(
        aes_string(x = "x", y = c_names[i]),
        color = line.col[i], linewidth = line.size)
    }
    
    else {
      gg <- gg +
      geom_line(
        aes_string(x = "x", y = c_names[i]),
        color = line.col[i], linetype = "dashed", linewidth = line.size)
    }
    
  }
  
  gg <- gg +
    scale_y_continuous(label = comma, limits = ylims) +
    scale_x_continuous(breaks = c(108,120,132,144, 156, 168,180,192),
                     labels = c(9,10,11,12,13,14,15,16)) +
    labs(x = "Age (Years)", y = TeX("Cortical Surface Area in $mm^2$"),
         title = paste(
           "Centiles for", region_input, "\nfor", race_input, sex_input, "Adolescents", sep = " "),
         subtitle = "Using Box-Cox Power Exponential Original Family")
    theme_minimal()  
  
  return(gg)
}
</script>
 
<script type="application/shiny-prerendered" data-context="server-start">
# returns ggplot for given model and data used to create model
centiles_plot_thick <- function(
    cur_index,
    # x variable in data
    xcol,
    # y variable in data
    cur_ycol,
    cent = c(2.5, 50, 97.5),
    # whether to include points on plot in addition to centile curves
    points = TRUE,
    race_input = "",
    sex_input = "",
    ylims = c(125000, 250000),
    region_input = "Total Brain"
    ) {

  model_data <- subset_data(
    brain_data,
    xcol = "interview_age",
    ycol = cur_ycol,
    filter_var1 = "sex",
    filter_val1 = demog_brain_combos_thick[cur_index, 1],
    filter_var2 = "race_ethnicity",
    filter_val2 = demog_brain_combos_thick[cur_index, 2])
  
  centile_data <- centiles_list_thick[[cur_index]]
  
  data_centiles <- as.numeric(str_replace(colnames(centile_data), "centile.", "")[1:11])
  cent_cols <- names(centile_data)[data_centiles %in% cent]
  centile_data <- centile_data |>
    select(all_of(cent_cols), x)
  
  lc <- length(cent)
  c_names <- colnames(centile_data)
  line.size = 1.5
  line.col = hcl.colors(lc, palette = "Dark 2")
  line.type = rep(1, length(cent))
  
  # initialize ggplot object
  gg <- ggplot(data = centile_data)
  
  if (points == TRUE) {
    gg <- gg + geom_point(data = model_data, aes(x = xvar, y = yvar),
             size = 1, alpha = 0.2, show.legend = FALSE, color = "gray")
  }
  for (i in 1:lc) {
    
    if (c_names[i] == "centile.50") {
      gg <- gg +
      geom_line(
        aes_string(x = "x", y = c_names[i]),
        color = line.col[i], linewidth = line.size)
    }
    
    else {
      gg <- gg +
      geom_line(
        aes_string(x = "x", y = c_names[i]),
        color = line.col[i], linetype = "dashed", linewidth = line.size)
    }
    
  }
  
  gg <- gg +
    scale_y_continuous(label = comma, limits = ylims) +
    scale_x_continuous(breaks = c(108,120,132,144, 156, 168,180,192),
                     labels = c(9,10,11,12,13,14,15,16)) +
    labs(x = "Age (Years)", y = "Cortical Thickness in mm",
         title = paste(
           "Centiles for", region_input, "\nfor", race_input, sex_input, "Adolescents", sep = " "),
         subtitle = "Using Box-Cox Power T Family")
    theme_minimal()  
  
  return(gg)
}
</script>
 
<script type="application/shiny-prerendered" data-context="server-start">
#read in thickness data 
demog_thick_combos_est <- read.csv("additional data/demog_thick_combos.csv") |> 
  select(-X) |>
  mutate(race_ethnicity = if_else(race_ethnicity == "Other", "Not Listed", race_ethnicity))

thickness_df <- data.frame(read.csv("additional data/full_thickness_df.csv")) |> 
  select(-X) |> 
  rename_with(~ sub('^X', '', .)) |>
  mutate(race = if_else(race == "Other", "Not Listed", race))

load("additional data/thickness_parameters.RData")

# load all of the area data 
demog_area_combos_est <- read.csv("additional data/demog_area_combos.csv") |> 
  select(-X) |>
  mutate(race_ethnicity = if_else(race_ethnicity == "Other", "Not Listed", race_ethnicity))

area_df <- read.csv("additional data/full_area_df.csv") |> 
  select(-X) |> 
  rename_with(~ sub('^X', '', .)) |>
  mutate(race = if_else(race == "Other", "Not Listed", race))

load("additional data/area_parameters.RData")
</script>
 
<script type="application/shiny-prerendered" data-context="server-start">
elapsed_months <- function(end_date, start_date) {
    ed <- as.POSIXlt(end_date)
    sd <- as.POSIXlt(start_date)
    12 * (ed$year - sd$year) + (ed$mon - sd$mon)
}
</script>
 
<script type="application/shiny-prerendered" data-context="server-start">
#function to make centile curves
draw_centiles <- function(
    race_input,
    sex_input,
    hemisphere_input,
    region_input,
    centiles_input,
    phenotype_input
    ) { 
  
  #define dataframe based on phenotype input 
  working_df <- if (phenotype_input == "Cortical Thickness") { 
    thickness_df
  }
  else {area_df}

  #get df for region/group that we want 
  curr_df <- working_df |>
  filter(race == race_input, sex == sex_input, region == region_input) |>
  pivot_longer(
    cols = c(`107`:`189`), 
    names_to = "interview_age",
    values_to = "thickness"
    ) |> 
  filter(centile %in% as.vector(centiles_input)) |> 
  mutate(interview_age = as.numeric(interview_age),
         centile = as.factor(centile), 
         hemisphere = as.factor(hemisphere)) 
  
    #provision for hemispheres
  if (hemisphere_input %in% c("right", "left") | region_input == "all") { 
    curr_df <- curr_df |> filter(hemisphere == hemisphere_input)
    hemi_legend <- "none"}  else { hemi_legend <- NULL}
  
  #initialize ggplot object
  gg <- ggplot(data = curr_df) 
  
  #now add for every centile we wanna plot 
  gg <- gg + geom_line(aes(x = interview_age, y = thickness, color = centile, 
                           linetype = hemisphere), linewidth = 1.45)
  
  title <- if (race_input == "Not Listed") {
    paste("Centile Curves for", sex_input,
      "Adolescents (Race Not Listed)")
  }
  else {
    paste("Centile Curves for", race_input, sex_input, "Adolescents")
  }
  
  gg <- gg + 
    theme_minimal() + 
    labs(title = title)  + 
    scale_color_manual(
      values = c(`0.4` = "#A30015", `2` = "#E97451", `2.5` = "#FFD700", 
                 `10` = "#379634", `25` = "#124019", `50` = "#11686A",
                 `75` = "#08A4BD", `90` = "#C185B2", `97.5` = '#B91372',
                 `98` = '#63264A', `99.6` = '#E2B4BD')) + 
    theme(legend.position = "bottom") + 
    theme(plot.title = element_text(face = "italic", size = 18), 
          axis.title = element_text(size = 15), 
          axis.text = element_text(size = 13), 
          legend.text = element_text(size = 13), 
          legend.title = element_text(size = 15)) + 
    guides(linetype = hemi_legend) + 
    scale_x_continuous(breaks = c(108,120,132,144, 156, 168,180),
                     labels = c(9,10,11,12,13,14,15)) + 
    xlab("Adolescent Age (Years)") + 
    ylab("Cortical Thickness (mm)") 
  
  
  return(gg)
    }
</script>
 
<script type="application/shiny-prerendered" data-context="server-start">
#function to calculate centile values

calculate_centile <- function(
  race_input,
  sex_input,
  age_input,
  region_input,
  hemisphere_input, 
  thickness_input,
  phenotype_input
  ) { 
  
  demog_brain_combos <- if (phenotype_input == "Cortical Thickness") { 
    demog_thick_combos_est
  } else {
      demog_area_combos_est
    }
  

  
  phenotype_parameters <- if (phenotype_input == "Cortical Thickness") { 
    thickness_parameters } 
  else { area_parameters}
  
  pfun <- if (phenotype_input == "Cortical Thickness") { 
    "pBCTo"} else { "pBCPEo"}
  
  # need to make provision for if user is looking at both hemispheres
  # (and not at the full brain)
  if (!(hemisphere_input == "right" | hemisphere_input == "left") &
          region_input != "all") { 
    
    indices <- which(
      demog_brain_combos$sex == sex_input &
      demog_brain_combos$race_ethnicity == race_input &
      demog_brain_combos$region == region_input)
    
    parameters_df <- list(
      phenotype_parameters[[indices[1]]], phenotype_parameters[[indices[2]]])
    
   }
  
  else { 
      
     index <- which(
        demog_brain_combos$sex == sex_input &
        demog_brain_combos$race_ethnicity == race_input &
        demog_brain_combos$region == region_input &
        demog_brain_combos$hemisphere == hemisphere_input)
  
    parameters_df <- list(phenotype_parameters[[index]])
    
  }
  
  #if we don't have parameters for the age input round down to the nearest age
  if (!(age_input %in% as.vector(parameters_df[[1]]$x))) {
    age_index <- which(abs(as.vector(parameters_df[[1]]$x) - age_input) == 
                           min(abs((parameters_df[[1]]$x - age_input))))
    
    age_input <- min(parameters_df[[1]]$x[age_index])
  } 
  
  #get index for specific age 
  age_index <- which(parameters_df[[1]]$x == age_input)
  
  final_centiles <- c()
  for (index in 1:length(parameters_df)) { 
    curr_param_df <- parameters_df[[index]]
    mu <- curr_param_df$mu[age_index]
    sigma <- curr_param_df$sigma[age_index] 
    nu <- curr_param_df$nu[age_index]
    tau <- curr_param_df$tau[age_index]
    
    curr_centile <- call(pfun, q = thickness_input, mu = mu, sigma = sigma,
                         nu = nu, tau = tau)
    curr_centile <- eval(curr_centile)
    curr_centile <- round(curr_centile, digits = 5)
    final_centiles[index] <- curr_centile*100
    
    }
  
  
  return(final_centiles)
  
}
</script>
 
<script type="application/shiny-prerendered" data-context="server">
output$ctplot <- renderPlot({ 
  
  
  #initialize stuff
  timepoints <- c("baseline", "year 2", "year 4")
  values <- c(input$baseline_input, input$year2_input, input$year4_input)
  
  #define age in months
  
  baseline_age_input <- elapsed_months(input$baseline_date, input$birthday)
  year2_age <- elapsed_months(input$year2_date, input$birthday) 
  year4_age <- elapsed_months(input$year4_date, input$birthday)
  ages <- c(baseline_age_input, year2_age, year4_age)
  
  #extract the ages + centiles + values for which we will be calculating 
  
  value_indices <- as.vector(which(values != 0))
  timepoints <- timepoints[value_indices]
  values_calc <- values[value_indices]
  ages_calc <- ages[value_indices]
  race <- input$race 
  sex <- input$sex 
  region <- input$region 
  hemi <- input$hemi
  phenotype <- input$phenotype
  
  if (!(hemi %in% c("left", "right")) & region != "all") { 
    hemi_labels <- c("left", "right")}
  else { hemi_labels <- NULL}
  
  #provisions for diff plot sizes 
  
  label_spacer <- if (phenotype == "Cortical Thickness") { 
    c(0.1, -0.1) }
    else if (phenotype == "Cortical Surface Area" & region != "all") {
    c(100, -100) }
    else {c(10000, -10000)}
  
  
  #base centile plot 
  gg <- draw_centiles(
    race_input = race,
    sex_input = sex,
    hemisphere_input = hemi,
    region_input = region,
    centiles_input = input$centiles,
    phenotype_input = phenotype
    )
  
  
  #define centiles and round them to four digits and put them in a list 
  #if we're calculating both hemispheres then we want to do this for 
  centile_values <- c()
  
  if (length(value_indices) != 0) { 

    for (i in 1:length(value_indices)) { 
      curr_centile <- calculate_centile(
        race_input = race,
        sex_input = sex,
        age_input = ages_calc[i], 
        region_input = region,
        hemisphere_input = hemi,
        thickness_input = values_calc[i],
        phenotype_input = phenotype)
      curr_centile <- round(curr_centile, digits = 4)
      centile_values[[i]] <- curr_centile
    
      }
  
  # if we get both hemispheres it looks like  c([0.34, 1.290], [94, 32])
  #add user points & centile estimates to the plot 

    for (i in 1:length(value_indices)) { 
      timepoint <- timepoints[i]
      curr_centile <- centile_values[[i]]
    
      gg <- gg +
        annotate("point", x = ages_calc[i], y = values_calc[i], size = 3,
          color = "#05668D")
    
    #default is for the left centile label to be displayed above the right one
    #but if the left centile value is bigger it means that the left curve is below the right one so switch it to the bottom 
      if (length(curr_centile) > 1 & curr_centile[1] > curr_centile[2]) { 
        label_spacer <- list.reverse(label_spacer)}
    
      for (hemi_index in 1:length(hemi_labels)) { 
        gg <- gg +
          annotate("label", x = ages_calc[i], y = values_calc[i] +
            label_spacer[hemi_index], size = 5,
          label = (paste(timepoint, hemi_labels[hemi_index], "centile:", "\n",
                      curr_centile[hemi_index])))
      }
    }
    
    # and line segments connecting the points if we have 2+ points 
    if (length(value_indices) > 1) {
      for (i in 1:length(value_indices)-1) {
        gg <- gg +
          annotate("segment", x = ages_calc[i], y = values_calc[i],
            xend = ages_calc[i+1], yend = values_calc[i+1], color = "#4C4B63",
              size = 1.25, linetype = 3)
      }
    }
    
  }
  
  gg
  
  })
</script>
 
<script type="application/shiny-prerendered" data-context="server-start">
log_ratio <- function(orig_df) {
  
 peak_df1 <- orig_df |> 
  group_by(region, hemisphere, sex, race) |> 
  pivot_longer(cols = `107`:`189`, names_to = "age", values_to = "value") |> 
  summarize(region_max = max(value, na.rm = TRUE),
            .groups = 'rowwise') |> 
  right_join(thickness_df, by = c("region", "sex", "race", "hemisphere"))

  long_df <- orig_df |>
    pivot_longer(cols = `107`:`189`, names_to = "age", values_to = "value") |>
    left_join(peak_df1 |> select(region, sex, race, hemisphere, centile, region_max), 
              by = c("region", "sex", "race", "hemisphere", "centile")) |>
    mutate(ratio = region_max / value)

  log_maxes <- long_df |>
    select(region, centile, hemisphere, sex, race, age, ratio) |>
    pivot_wider(names_from = age, values_from = ratio) |> 
    mutate(across(`107`:`189`, log, .names = "log_{.col}"))
  
  #final df
  final_df <- log_maxes |>
    select(region, hemisphere, sex, race, centile, starts_with("log_")) |> 
    rename_with(~ sub("^log_", "", .), starts_with("log_"))
  
  return(final_df)
}
</script>
 
<script type="application/shiny-prerendered" data-context="server-start">
#take log ratios
thickness_logs <- log_ratio(thickness_df)
area_logs <- log_ratio(area_df)

#makes a plot for a specific centile + race/sex combo 
plot_centile <- function(
    centile_input,
    age_input,
    race_input,
    sex_input, 
    statistic_input,
    phenotype_input,
    hemi_input) { 
  
 
  #define dataframe based on what user wants to see 
   working_df <- if (statistic_input == "Raw Data") {
    if (phenotype_input == "Cortical Thickness") {thickness_df}
    else {area_df}
   }
   else {
    if (phenotype_input == "Cortical Thickness") {thickness_logs}
    else {area_logs}
   }
   
  #define limits based on input 
  pheno_limits <- if (statistic_input == "Scaled Regional Max Ratio") { 
    if (phenotype_input == "Cortical Thickness") {c(0, 0.35)}
    else {c(0, 1)}
  }
  else if (phenotype_input == "Cortical Thickness") {c(1.3, 4)}
  else {c(0, 15000)}
  
  legend_name <- if (statistic_input == "Scaled Regional Max Ratio") { 
  "log(max/centile value)"
  }
  else {
    if (phenotype_input == "Cortical Thickness") {"cortical thickness (mm)"} 
    else{TeX("cortical surface area ($mm^2)$")}
  }
  
  #define geom brain object depending on hemisphere input
  geom_brain_obj <- if (hemi_input == "Both") {
    geom_brain(atlas = dk, aes(fill = values))
  }
  else {
   geom_brain(atlas = dk, 
              hemi = as.character(hemi_input), 
               aes(fill = values))
  }
  
  working_df <- working_df |> 
    filter(race == race_input, sex == sex_input) |> 
    filter(centile == centile_input) 
  
  working_df$values <- working_df[[age_input]]
  
  #make title make sense for "2nd" 
  if (centile_input == 2) {plot_title <- "2nd percentile"}
  else {plot_title <- paste(centile_input, "th percentile", sep = "")}
  
  plot <- working_df |> 
    ggplot() + 
    geom_brain_obj + 
    scale_fill_gradientn( 
      name = legend_name, 
      colors = turbo(45), 
      limits = pheno_limits) + 
    labs(title = plot_title) + 
    theme_void()
  
  return(plot)
  }
</script>
 
<script type="application/shiny-prerendered" data-context="server-start">
plot_centiles <- function(
    centiles_input,
    age_input,
    race_input,
    sex_input,
    statistic_input,
    phenotype_input,
    hemi_input
    ) { 

  plot_outputs <- c()
  
  age_years <- round(as.numeric(age_input)/12, digits = 4)
  
  for (i in 1:length(centiles_input)) { 
    curr_centile <- centiles_input[i] 
    plot <- plot_centile(curr_centile, age_input, race_input, sex_input, 
                         statistic_input, phenotype_input, hemi_input)
    plot_outputs[[i]] <- plot
    }
  


  if (race_input == "All" & sex_input != "All") { 
    title <- paste("Centile Visualizations for all", sex_input,
                   "Adolescents --", age_input, "Months")}
  if (race_input != "All" & sex_input != "All") { 
    title <- paste("Centile Visualizations for", race_input, sex_input,
                   "Adolescents --", age_years, "Years")}
  
  
  nCol = floor(sqrt(length(centiles_input)))
  #top_text <- text_grob(title, gp = gpar(fontsize = 15, font = 8))
  
  final_plot <- do.call("grid.arrange", 
                        c(plot_outputs, ncol = nCol, top = title))
  
  return(final_plot)
  
}
</script>
 
<script type="application/shiny-prerendered" data-context="server">
output$brainPlot <- renderPlot({

  plot_centiles(
    centiles_input = input$centiles_brain,
    age_input = as.character(input$age_brain),
    race_input = input$race_brain,
    sex_input = input$sex_brain,
    statistic_input = input$statistic,
    phenotype_input = input$phenotype_brain,
    hemi_input = input$hemi_brain)
  })

</script>
 
<script type="application/shiny-prerendered" data-context="server">
output$thick_centile_plot_1 <- renderPlot({
  
  demog_brain_combos_thick <- as.data.frame(demog_brain_combos_thick)

  race3 <- input$race3[1]
  sex3 <- input$sex3[1]

  centiles_to_plot <- as.numeric(input$centiles_thickness)
  region_label <-  input$thickness_var[1]
  region_var <- thickness_labels$var_name[which(thickness_labels$var_label == region_label)]
  
  index <- which(demog_brain_combos_thick$sex == sex3 &
                 demog_brain_combos_thick$race_ethnicity == race3 &
                 demog_brain_combos_thick$var_label == region_label)

  demog_brain_combos_thick <- as.matrix(demog_brain_combos_thick)

  y_limits <- c(as.numeric(demog_brain_combos_thick[index, 5]),
                as.numeric(demog_brain_combos_thick[index, 6]))
  
  centiles_plot_thick(
    cur_index = index,
    xcol = substitute(interview_age),
    cur_ycol = region_var,
    cent = centiles_to_plot,
    race_input = race3,
    sex_input = sex3,
    ylims = y_limits,
    region_input = region_label
  )
  
})

output$thick_centile_plot_2 <- renderPlot({
  
  demog_brain_combos_thick <- as.data.frame(demog_brain_combos_thick)

  race4 <- input$race4[1]
  sex4 <- input$sex4[1]
  centiles_to_plot <- as.numeric(input$centiles_thickness)
  region_label <-  input$thickness_var[1]
  region_var <- thickness_labels$var_name[which(thickness_labels$var_label == region_label)]
  
  index <- which(demog_brain_combos_thick$sex == sex4 &
                 demog_brain_combos_thick$race_ethnicity == race4 &
                 demog_brain_combos_thick$var_label == region_label)

  demog_brain_combos_thick <- as.matrix(demog_brain_combos_thick)

  y_limits <- c(as.numeric(demog_brain_combos_thick[index, 5]),
                as.numeric(demog_brain_combos_thick[index, 6]))

  centiles_plot_thick(
    cur_index = index,
    xcol = substitute(interview_age),
    cur_ycol = region_var,
    cent = centiles_to_plot,
    race_input = race4,
    sex_input = sex4,
    ylims = y_limits,
    region_input = region_label
  )
  
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
output$area_centile_plot_1 <- renderPlot({
  
  demog_brain_combos_area <- as.data.frame(demog_brain_combos_area)

  race1 <- input$race1[1]
  sex1 <- input$sex1[1]
  centiles_to_plot <- as.numeric(input$centiles_area)
  region_label <- input$area_var[1]
  region_var <- area_labels$var_name[which(area_labels$var_label == region_label)]
  
  index <- which(demog_brain_combos_area$sex == sex1 & demog_brain_combos_area$race_ethnicity == race1 & demog_brain_combos_area$brain_location == region_label)

  demog_brain_combos_area <- as.matrix(demog_brain_combos_area)

  y_limits <- c(as.numeric(demog_brain_combos_area[index, 5]),
                as.numeric(demog_brain_combos_area[index, 6]))

  centiles_plot(
    cur_index = index,
    xcol = substitute(interview_age),
    cur_ycol = region_var,
    cent = centiles_to_plot,
    race_input = race1,
    sex_input = sex1,
    ylims = y_limits,
    region_input = region_label
  )
  
})

output$area_centile_plot_2 <- renderPlot({
  
  demog_brain_combos_area <- as.data.frame(demog_brain_combos_area)

  race2 <- input$race2[1]
  sex2 <- input$sex2[1]
  centiles_to_plot <- as.numeric(input$centiles_area)
  region_label <- input$area_var[1]
  region_var <- area_labels$var_name[which(area_labels$var_label == region_label)]
  
  index <- which(demog_brain_combos_area$sex == sex2 & demog_brain_combos_area$race_ethnicity == race2 & demog_brain_combos_area$brain_location == region_label)

  demog_brain_combos_area <- as.matrix(demog_brain_combos_area)

  y_limits <- c(as.numeric(demog_brain_combos_area[index, 5]),
                as.numeric(demog_brain_combos_area[index, 6]))

  centiles_plot(
    cur_index = index,
    xcol = substitute(interview_age),
    cur_ycol = region_var,
    cent = centiles_to_plot,
    race_input = race2,
    sex_input = sex2,
    ylims = y_limits,
    region_input = region_label
  )
  
})
</script>
 
<script type="application/shiny-prerendered" data-context="server-extras">
ojs_define <- function(..., .session = shiny::getDefaultReactiveDomain()) {
  quos <- rlang::enquos(...)
  vars <- rlang::list2(...)
  nm <- names(vars)
  if (is.null(nm)) {
    nm <- rep_len("", length(vars))
  }
  mapply(function(q, nm, val) {
    # Infer name, if possible
    if (nm == "") {
      tryCatch({
        nm <- rlang::as_name(q)
      }, error = function(e) {
        code <- paste(collapse = "\n", deparse(rlang::f_rhs(q)))
        stop("ojs_define() could not create a name for the argument: ", code)
      })
    }
    .session$output[[nm]] <- val
    outputOptions(.session$output, nm, suspendWhenHidden = FALSE)
    .session$sendCustomMessage("ojs-export", list(name = nm))
    NULL
  }, quos, nm, vars, SIMPLIFY = FALSE, USE.NAMES = FALSE)
  invisible()
}
</script>
</p>
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap-datepicker-js"]},{"type":"character","attributes":{},"value":["1.9.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/datepicker"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/bootstrap-datepicker.min.js"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["<script>(function() {\n        var datepicker = $.fn.datepicker.noConflict();\n        $.fn.bsDatepicker = datepicker;\n      })();\n     <\/script>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap-datepicker-css"]},{"type":"character","attributes":{},"value":["1.9.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/datepicker"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/bootstrap-datepicker3.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap-datepicker-js"]},{"type":"character","attributes":{},"value":["1.9.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/datepicker"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/bootstrap-datepicker.min.js"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["<script>(function() {\n        var datepicker = $.fn.datepicker.noConflict();\n        $.fn.bsDatepicker = datepicker;\n      })();\n     <\/script>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap-datepicker-css"]},{"type":"character","attributes":{},"value":["1.9.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/datepicker"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/bootstrap-datepicker3.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap-datepicker-js"]},{"type":"character","attributes":{},"value":["1.9.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/datepicker"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/bootstrap-datepicker.min.js"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["<script>(function() {\n        var datepicker = $.fn.datepicker.noConflict();\n        $.fn.bsDatepicker = datepicker;\n      })();\n     <\/script>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap-datepicker-css"]},{"type":"character","attributes":{},"value":["1.9.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/datepicker"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/bootstrap-datepicker3.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap-datepicker-js"]},{"type":"character","attributes":{},"value":["1.9.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/datepicker"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/bootstrap-datepicker.min.js"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["<script>(function() {\n        var datepicker = $.fn.datepicker.noConflict();\n        $.fn.bsDatepicker = datepicker;\n      })();\n     <\/script>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap-datepicker-css"]},{"type":"character","attributes":{},"value":["1.9.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/datepicker"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/bootstrap-datepicker3.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-javascript"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-css"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135]}},"value":[{"type":"character","attributes":{},"value":["abind","backports","base","bit","bit64","broom","broom.helpers","bslib","cachem","car","carData","class","classInt","cli","codetools","colorspace","commonmark","compiler","crayon","data.table","datasets","DBI","digest","doParallel","dplyr","DT","e1071","ellipse","evaluate","extrafont","extrafontdb","fansi","fastmap","forcats","foreach","gamlss","gamlss.data","gamlss.dist","gamlss.foreach","gamlss.ggplots","gamlss.inf","generics","ggplot2","ggpubr","ggridges","ggseg","ggseg3d","ggsignif","glmnet","glue","graphics","grDevices","grid","gridExtra","gt","gtable","gtsummary","hms","htmltools","htmlwidgets","httpuv","httr","iterators","janitor","jquerylib","jsonlite","kableExtra","KernSmooth","knitr","later","latex2exp","lattice","lazyeval","lifecycle","lubridate","magrittr","markdown","MASS","Matrix","memoise","methods","mgcv","mime","munsell","nlme","parallel","patchwork","pillar","pkgconfig","plotly","promises","proxy","purrr","R6","Rcpp","readr","rlang","rlist","rmarkdown","rstatix","rstudioapi","Rttf2pt1","sass","scales","sf","shape","shiny","snakecase","splines","stats","stringi","stringr","survival","svglite","systemfonts","tibble","tidyr","tidyselect","tidyverse","timechange","tools","tzdb","units","utf8","utils","vctrs","viridis","viridisLite","vroom","withr","xfun","xml2","xtable","yaImpute","yaml"]},{"type":"character","attributes":{},"value":["1.4-5","1.5.0","4.4.1","4.0.5","4.0.5","1.0.6","1.15.0","0.7.0","1.1.0","3.1-2","3.0-5","7.3-22","0.4-10","3.6.3","0.2-20","2.1-0","1.9.1","4.4.1","1.5.3","1.15.4","4.4.1","1.2.3","0.6.36","1.0.17","1.1.4","0.33","1.7-14","0.5.0","0.24.0","0.19","1.0","1.0.6","1.2.0","1.0.0","1.5.2","5.4-22","6.0-6","6.1-1","1.1-6","2.1-12","1.0-1","0.1.3","3.5.1","0.6.0","0.5.6","1.6.5","1.6.3","0.6.4","4.1-8","1.7.0","4.4.1","4.4.1","4.4.1","2.3","0.10.1","0.3.5","1.7.2","1.1.3","0.5.8.1","1.6.4","1.6.15","1.4.7","1.0.14","2.2.0","0.1.4","1.8.8","1.4.0","2.23-24","1.47","1.3.2","0.9.6","0.22-6","0.2.2","1.0.4","1.9.3","2.0.3","1.13","7.3-60.2","1.7-0","2.0.1","4.4.1","1.9-1","0.12","0.5.1","3.1-164","4.4.1","1.2.0","1.9.0","2.0.3","4.10.4","1.3.0","0.4-27","1.0.2","2.5.1","1.0.12","2.1.5","1.1.4","0.4.6.2","2.27","0.7.2","0.16.0","1.3.12","0.4.9","1.3.0","1.0-16","1.4.6.1","1.8.1.1","0.11.1","4.4.1","4.4.1","1.8.4","1.5.1","3.6-4","2.1.3","1.1.0","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","4.4.1","0.4.0","0.8-5","1.2.4","4.4.1","0.6.5","0.6.5","0.4.2","1.6.5","3.0.0","0.45","1.3.6","1.8-4","1.0-34","2.3.9"]}]}]}
</script>
<!--/html_preserve-->


<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /container fluid -->

<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (_event) {
  if (window.bslib.Card) {
    window.bslib.Card.initializeAllCards();
  }
}); 
</script>
  



</body></html>